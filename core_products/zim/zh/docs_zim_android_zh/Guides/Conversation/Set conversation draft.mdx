---
articleID: 20883
---

import {getPlatformData} from "/snippets/utils-content-parser.js"

export const setConversationDraftMap = {
  'Android': <a href='@setConversationDraft' target='_blank'>setConversationDraft</a>,
}
export const onConversationChangedMap = {
  'Android': <a href='@onConversationChanged' target='_blank'>onConversationChanged</a>,
  'Web': <a href='@conversationChanged' target='_blank'>conversationChanged</a>,
  'iOS': <a href='https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_ios~protocol~ZIMEventHandler#zim-conversation-changed' target='_blank'>conversationChanged</a>,
  'mac': <a href='https://doc-zh.zego.im/article/api?doc=zim_API~objective-c_macos~protocol~ZIMEventHandler#zim-conversation-changed' target='_blank'>conversationChanged</a>,
}



# 保存会话草稿

- - -

## 功能简介

会话草稿，指用户正在编辑但尚未发送的文本消息。ZIM 支持用户退出会话后仍在本地保存会话草稿，以便继续编辑。

## 实现流程

调用 {getPlatformData(props,setConversationDraftMap)} 接口，传入 conversationID 与conversationType 指定某个会话，即可将草稿保存到会话。

<Note title="说明">

如需清除会话草稿，`draft` 字段请传空字符串。
</Note>

保存草稿成功后，可以通过 {getPlatformData(props,onConversationChangedMap)} 回调接口获取草稿变更后的会话信息。

:::if{props.platform=undefined}
<CodeGroup>
```java title="示例代码"
// 为某个会话设置草稿
// 以群聊会话为例
zim.setConversationDraft("draft", "Group_ID", ZIMConversationType.GROUP, new ZIMConversationDraftSetCallback() {
    @Override
    public void onConversationDraftSet(ZIMError errorInfo) {
             // 设置草稿后的回调。
        }
});
```
</CodeGroup>
:::
:::if{props.platform="iOS|mac"}
<CodeGroup>
```objc title="示例代码"
// 为某个会话设置草稿
// 以群聊会话为例
zim.setConversationDraft("draft", "Group_ID", ZIMConversationType.GROUP, new ZIMConversationDraftSetCallback() {
    @Override
    public void onConversationDraftSet(ZIMError errorInfo) {
             // 设置草稿后的回调。
        }
});
```
</CodeGroup>
:::
:::if{props.platform="Web"}
<CodeGroup>
```javascript title="示例代码"
// 为某个会话设置草稿
// 以群聊消息为例
zim.setConversationDraft("draft", "Group_ID", 2).then(function({ conversationID, conversationType }){
        // 保存成功后的业务逻辑
    })
    .catch(function(err){
        // 请查看错误码文档获取解决建议
    });
```
</CodeGroup>
:::
:::if{props.platform="window"}
<CodeGroup>
```Cpp title="示例代码"
// 为某个会话设置草稿
// 以群聊消息为例
zim->setConversationDraft("draft", "Group_ID", zim::ZIM_CONVERSATION_TYPE_GROUP, [=](const std::string& conversationID, zim::ZIMConversationType conversationType, const zim::ZIMError& errorInfo) {
    // 保存会话草稿的操作结果
    if (errorInfo.code == zim::ZIM_ERROR_CODE_SUCCESS) {
        // 保存成功后的业务逻辑
    } else {
        // 请查看错误码文档获取解决建议
    }
});
```
</CodeGroup>
:::
